<!DOCTYPE html>
<html lang="ru">
<meta charset="utf-8">
<title>Хэшировать ли публичные ключи в Биткоин-адресах? | Блокчейн &amp; Разработка</title>
<link rel="icon" href="/favicon.ico">
<meta name="generator" content="Hugo 0.70.0-DEV" />
<meta name="description" content="Блог о разработке и блокчейн-технологиях. Код, сети, паранойя.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://blockndev.com/css/index.css">
<link rel="stylesheet" href="https://blockndev.com/css/classes.css">
<link rel="canonical" href="https://blockndev.com/posts/public-keys-should-be-public/">
<link rel="alternate" type="application/rss+xml" href="" title="Блокчейн &amp; Разработка">

<body>

<header class="icons">
  <i class="col-1">&nbsp;</i>
  
    <a class="col-1" href="https://blockndev.com/">Блокчейн &amp; Разработка</a>
  
  
    <nav class="col-1 navigation">
    
      <a href="https://t.me/blockndev" >
        
          
          
          <span ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></span>
          <span class="hidden">Telegram</span>
        
      </a>
    
      <a href="mailto:me@jeiwan.ru" >
        
          
          
          <span ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg></span>
          <span class="hidden">Mail</span>
        
      </a>
    
      <a href="https://github.com/Jeiwan" >
        
          
          
          <span ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
          <span class="hidden">Github</span>
        
      </a>
    
      <a href="/index.xml" >
        
          
          
          <span ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg></span>
          <span class="hidden">Subscribe</span>
        
      </a>
    
    </nav>
  
</header>

<article>
  <header>
    <a href="https://blockndev.com/categories/%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B8%D0%BD/">БИТКОИН</a>, <a href="https://blockndev.com/categories/%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%8F/">КРИПТОГРАФИЯ</a><h1>Хэшировать ли публичные ключи в Биткоин-адресах?</h1>
    <time datetime="2020-04-11T00:00:00Z">11 April 2020</time>
  </header>
  <p><em>Как вы знаете, Биткоин-адрес это хэш публичного ключа, закодированный в Base58 (за исключением bech32-адресов) для более удобного чтения. Когда вы переводите биткоины на адрес, вы переводите их именно на хэш публичного ключа, а когда вы выводите их с адреса, вы должны раскрыть сам публичный ключ. Но так было не всегда. В самой первой версии Биткоина, выпущенной Сатоши, перевод происходил на публичный ключ. Это считалось небезопасным, поэтому было сделано хэширование ключей. Но действительно ли открытые публичные ключи это такая проблема? Предлагаю вам прочитать мнение Питера Вулле (Pieter Wuille) на этот счёт.</em></p>
<h2 id="теория">Теория</h2>
<p>Считается, что, чтобы подделать ECDSA-подпись, имея публичный ключ, нужно вычислить приватный ключ для него (эта операция называется дискретным логарифмом — сложность её вычисления и лежит в основе надежности ECDSA). И для этого нужно сначала получить публичный ключ.</p>
<p>Имея публичный ключ, вам нужно совершить 2128 операций, чтобы найти соответствующий ему приватный. Это просто чудовищное количество работы (даже если каждый компьютер в мире сможет делать одну операцию за один такт процессора, то потребуется более 100 миллионов лет; на практике потребуется на несколько порядков больше времени). Однако эти вычисления не учитывают развития алгоритмов решения задачи дискретного логарифма и развития квантовых компьютеров. Достаточно мощный квантовый компьютер (ничего близкого к такому пока не существует) сможет решить эту задачу <em>намного</em> быстрее.</p>
<p>Используя в адресах хэш публичного ключа, а не сам публичны ключ, публичный ключ становится известным всем только в момент расходования выхода транзакции. Если не учитывать (невероятные) уязвимости, найденные в используемых хэш-функциях (SHA256 и RIPEMD160), то восстановление ключа из хэша это непростая задача даже для квантовых компьютеров. Но все же 160-битные хэши считаются относительно слабыми (для их взлома требуется 280 операций на квантовом компьютере).</p>
<p>Проще говоря, хэширование публичных ключей в адресах сильно затрудняет кражу монет на квантовом компьютере или через взлом дискретных логарифмов.</p>
<h2 id="практика">Практика</h2>
<p>В этом разделе я выскажу своё мнение, с которым некоторые могут не согласиться.</p>
<p>Я считаю, что польза от хэширования публичных ключей в лучшем случае незначительна. В худшем случае хэширование создаёт ложное ощущение безопасности. На это есть несколько причин:</p>
<ol>
<li>Польза от хэширования есть только до момента расходования выхода траназакции. Как только кто-то попытается вывести биткоины с P2PKH-выхода (Pay-to-public-key-hash, оплата на хэш публичного ключа), публичный ключ будет раскрыт. Сговорившись с майнерами, злоумышленник может затормозить добычу транзакции, попытаться восстановить приватный ключ из раскрытого публичного с помощью квантового компьютера и украсть монеты.</li>
<li>Люди продолжают использовать одни и те же адреса, и этого трудно избежать. Если адрес переиспользуется, то в момент первого расходования публичный ключ становится известен всем, его хэширование больше не помогает.</li>
<li>Почти все самые интересные варианты использования Биткоина (мультиподписи, 2FA, эскроу, платёжные каналы, BIP32-аккаунты) требуют обмена публичными ключами друг с другом. Считать, что в таких сценариях хэширование публичных ключей даёт какую-то защиту, было бы самообманом: публичные ключи и так постоянно раскрываются, даже если пользователи об этом не подозревают.</li>
<li>Даже если вы будете строго следить за тем, чтобы не раскрывать свои публичные ключи и не пользоваться вышеприведёнными механиками, в блокчейне Биткоина хранится более 5 миллионов биткоинов (по моим расчетам) с открытыми публичными ключами. Не могу себе представить, что биткоин будет иметь хоть какую-то стоимость, если кому-то удасться украсть эти 5 миллионов.</li>
</ol>
<p>Но это не значит, что у нас есть проблемы. До создания достаточно мощных квантовых компьютеров ещё очень далеко (если вообще возможно создать квантовые компьютеры с таким гигантским количеством q-битов, которые необходимы для решения дискретных логарифмов). И это даёт нам время перейти на алгоритмы, стойкие к квантовым вычислениям (перестать использовать ECDSA и похожие алгоритмы). Этот переход ещё пока не сделан, так как у существующих алгоритмов, устойчивых к квантовым вычислениям, есть несколько недостатков, таких как очень длинные ключи и подписи. Из-за этого они пока очень непопулярны, но исследования продолжаются, и если они понадобятся, то они есть.</p>
<h2 id="должны-ли-мы-использовать-публичные-ключи-в-качестве-адресов">Должны ли мы использовать публичные ключи в качестве адресов?</h2>
<p><em>Вопрос: если создавать новую криптовалюту, то стоит ли сразу использовать закодированные в Base58 публичные адреса с чексуммой?</em></p>
<p>Тапрут именно это и делает. Тапрут-выходы (а значит и адреса) содержат полные публичные ключи — у этого есть несколько преимуществ, например: они короче, дешевле и позволяют создавать поверх них более сложные протоколы. Для таких выходов используется формат адресов Bech32, у которого тоже есть несколько преимуществ над Base58: проще конвертировать в удобную для чтения форму и сравнивать друг с другом, более надежная проверка на ошибки, формат более расширяемый, меньший размер QR-кодов и т. д.</p>
<p>Дисклаймер: я соавтор протокола Тапрут и стандарта Bech32.</p>
<p><strong>TL;DR публичные ключи должны быть публичными.</strong></p>
<p>Оригинал: <a href="https://bitcoin.stackexchange.com/a/95133">https://bitcoin.stackexchange.com/a/95133</a></p>

</article>



</body>

</html>
